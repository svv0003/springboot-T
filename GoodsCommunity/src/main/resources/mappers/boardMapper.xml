<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.thejoeun.board.model.mapper.BoardMapper">

    <!--
    ORACLE 에서는 NULLS LAST 를 이용하여 NULL 값을 처리한다.
    -->
    <select id="getAllBoard"  resultType="Board">
        SELECT *
        FROM board
        ORDER BY created_at DESC NULLS LAST , id DESC
    </select>

    <select id="getBoardById" resultType="board">
        SELECT *
        FROM board
        WHERE id = #{id}
    </select>

    <!--
    keyColumn = "id"
    Oracle에서 AUTO_INCREMENT 처리방법이다.
    1. SEQUENCE 전통적인 방법으로 자동 번호 생성 로직 작성한다.
    2. IDENTITY 컬럼을 사용하면 AUTO_INCREMENT 처럼 번호가 자동으로 생성되어 추가된다.
    IDENTITY 형식을 사용해서 insert 많이 한다.

    useGeneratedKeys    : DB에서 자동으로 생성된 키를 가져올 지 여부를 지정한다. 기본값은 false.
    keyProperty         : 자동으로 생성된 키 값을 어떤 자바 객체의 필드에 담을 지 지정하는 속성이다.
    keyColumn           : 자동으로 생성되는 키의 컬럼명ㅇ르 지정한다. Oracle 에서 명시적으로 지정하는 것을 권장한다.
    -->

    <insert id="insertBoard" parameterType="Board" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        INSERT INTO board(title, content, writer)
        VALUES (#{title}, #{content}, #{writer})
    </insert>

    <update id="updateViewCount" parameterType="int">
        UPDATE board
        SET view_count = view_count + 1
        WHERE id = #{id}
    </update>

    <select id="getBoardId" parameterType="Board">
        SELECT
    </select>

</mapper>
